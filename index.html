<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
  <title>Radius5 â€” Almaty</title>

  <!-- Mapbox GL -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.16.1/mapbox-gl.css" rel="stylesheet"/>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.16.1/mapbox-gl.js"></script>

  <!-- Turf.js for geodesic circle -->
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

  <style>
    html,body,#map{margin:0;height:100%;width:100%;background:#000;overflow:hidden}
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    // your public token
    const ACCESS_TOKEN = 'pk.eyJ1Ijoic2lrYWZhbmthOTEiLCJhIjoiY21nczNuYmxrMG1yeTJsczhna2dsZHJ6ZCJ9.Svpm2ZWpAJFdaS54BiInUQ';
    mapboxgl.accessToken = ACCESS_TOKEN;

    // use explicit HTTPS style URL (works reliably on GitHub Pages/WebView)
    const STYLE_URL = 'https://api.mapbox.com/styles/v1/sikafanka91/cmgs3sw6a001l01r70vif0yx9?access_token=' + ACCESS_TOKEN;

    const center = [76.8897, 43.2389]; // Almaty
    const map = new mapboxgl.Map({
      container: 'map',
      style: STYLE_URL,
      center,
      zoom: 12,
      attributionControl: false
    });

    // no default controls, clean UI
    map.on('load', () => {
      // 5 km geodesic circle
      const circle = turf.circle(center, 5, { units: 'kilometers', steps: 128 });

      map.addSource('r5', { type: 'geojson', data: circle });

      // glow
      map.addLayer({
        id: 'r5-glow',
        type: 'line',
        source: 'r5',
        paint: {
          'line-color': '#7C3AED',
          'line-width': 18,
          'line-blur': 16,
          'line-opacity': 0.35
        }
      });

      // fill
      map.addLayer({
        id: 'r5-fill',
        type: 'fill',
        source: 'r5',
        paint: {
          'fill-color': '#7C3AED',
          'fill-opacity': 0.16
        }
      });

      // stroke
      map.addLayer({
        id: 'r5-stroke',
        type: 'line',
        source: 'r5',
        paint: {
          'line-color': '#60A5FA',
          'line-width': 3,
          'line-blur': 1.1,
          'line-opacity': 0.95
        }
      });

      // center dot
      map.addSource('r5-center', {
        type: 'geojson',
        data: { type: 'Feature', geometry: { type: 'Point', coordinates: center } }
      });
      map.addLayer({
        id: 'r5-center-dot',
        type: 'circle',
        source: 'r5-center',
        paint: {
          'circle-radius': 5,
          'circle-color': '#38BDF8',
          'circle-stroke-width': 2,
          'circle-stroke-color': '#0B0F16'
        }
      });

      // camera to circle
      const bbox = turf.bbox(circle);
      map.fitBounds(bbox, { padding: 40, duration: 700 });

      // pulse animation
      let t0 = performance.now();
      (function animate(){
        const t = (performance.now() - t0) / 1000;
        const pulse = (Math.sin(t * 2.2) + 1) / 2; // 0..1
        map.setPaintProperty('r5-fill', 'fill-opacity', 0.12 + pulse * 0.10);
        map.setPaintProperty('r5-glow', 'line-width', 14 + pulse * 8);
        map.setPaintProperty('r5-glow', 'line-opacity', 0.25 + pulse * 0.20);
        requestAnimationFrame(animate);
      })();
    });
  </script>
</body>
</html>
